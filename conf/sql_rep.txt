data : PyQt4.QtCore.QDate(2016, 5, 14) , inspect_id : AD20160514_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00003' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160514_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160514_00001_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160514_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
data : PyQt4.QtCore.QDate(2016, 5, 14) , inspect_id : AD20160514_00002 , layer_nm :  

view :create view extjob._view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = '') as ext left join nfsd. as origin on ext.ogc_fid = origin.ogc_fid
data : PyQt4.QtCore.QDate(2016, 5, 14) , inspect_id : AD20160514_00003 , layer_nm :  

view :create view extjob._view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = '') as ext left join nfsd. as origin on ext.ogc_fid = origin.ogc_fid
data : PyQt4.QtCore.QDate(2016, 5, 14) , inspect_id : AD20160514_00004 , layer_nm :  

view :create view extjob._view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = '') as ext left join nfsd. as origin on ext.ogc_fid = origin.ogc_fid
data : PyQt4.QtCore.QDate(2016, 5, 15) , inspect_id : AD20160515_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160515_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00001' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160515_00001' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00001' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 15) , inspect_id : AD20160515_00002 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160515_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00002' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160515_00002' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00002' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 15) , inspect_id : AD20160515_00003 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160515_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00003' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160515_00003' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00003' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 15) , inspect_id : AD20160515_00004 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160515_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00004' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160515_00004' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00004' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 15) , inspect_id : AD20160515_00005 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160515_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160515_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160515_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00005' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160515_00005' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160515_00005' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 16) , inspect_id : AD20160516_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160516_00001_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160516_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160516_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00001' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160516_00001' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160516_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00001' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 16) , inspect_id : AD20160516_00002 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160516_00001_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160516_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160516_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00002' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160516_00002' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160516_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00002' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 16) , inspect_id : AD20160516_00003 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160516_00001_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160516_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160516_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00003' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160516_00003' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160516_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00003' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 16) , inspect_id : AD20160516_00004 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160516_00001_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160516_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160516_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00004' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160516_00004' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160516_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00004' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 16) , inspect_id : AD20160516_00005 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160516_00001_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160516_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160516_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160516_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160516_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00005' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160516_00005' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160516_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00005' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 16) , inspect_id : AD20160516_00006 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.wkb_geometry = o.wkb_geometry ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.wkb_geometry = o.wkb_geometry) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160516_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00006') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160516_00006') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_boundary(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160516_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00006' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160516_00006' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160516_00006' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00001' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00001' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00001' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00002 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00002' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00002' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00003 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00003' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00003' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00004 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00004' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00004' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00004' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00005 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00005' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00005' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00005' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00006 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00006') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00006') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00006' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00006' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00006' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00007 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00007') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00007') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00007' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00007' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00007' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00008 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00008') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00008') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00008' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00008' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00008' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00009 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00009') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00009') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00009' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00009' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00009' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00010 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00010') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00010') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00010' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00010' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00011 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00011' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00011') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00011' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00011') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00011' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00011' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00011' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00011' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00011' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00012 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00012') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00012') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00012' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00012' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00013 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00013' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00013') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00013' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00013') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00013' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00013' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00013' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00013' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00013' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00014 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00014') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00014') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00014' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00014' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00015 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00015') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00015') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00015' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00015' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00016 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00016' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00016') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00016' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00016') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00016' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00016' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00016' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00016' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00016' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00017 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00017' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00017') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00017' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00017') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00017' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00017' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00017' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00017' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00017' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00018 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00018' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00018') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00018' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00018') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00018' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00018' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00018' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00018' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00018' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00019 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00019' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00019') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00019' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00019') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00019' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00019' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00019' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00019' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00019' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00001' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00001' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00002 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00002' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00002' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00002' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00003 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00003' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00003' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00003' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00004 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00004' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00004' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00005 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00005' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00005' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00005' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00006 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00006') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00006') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00006' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00006' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00006' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00006' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00007 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00007') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00007') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00007' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00007' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00008 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00008') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00008') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00008' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00008' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00009 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00009') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00009') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00009' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00009' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00010 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00010') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00010') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00010' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00010' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00011 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00011' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00011') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00011' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00011') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00011' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00011' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00011' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00011' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00011' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00012 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00012') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00012') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00012' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00012' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00012' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00013 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00013' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00013') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00013' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00013') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00013' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00013' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00013' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00013' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00013' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00014 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00014') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00014') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00014' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00014' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00014' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00015 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00015') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00015') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00015' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00015' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00015' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00016 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160514_00004' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160515_00006_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00016' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160515_00006_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00016') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00016' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160515_00006_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00016') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00016' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160515_00006_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00016' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00016' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00016' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160515_00006_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00016' and layer_nm = 'nf_a_b01000' ) as add

